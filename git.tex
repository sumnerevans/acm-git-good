\documentclass{beeper}

\usepackage{listings}

\title{Git Good}
\subtitle{How to understand Git}
\author{Sumner Evans}
\institute{Mines ACM}
\date{14 February 2023}

\begin{document}

\begin{frame}{A bit about me}
    My name is Sumner, I'm a \textbf{software engineer at Beeper}.
    \begin{itemize}
        \item I graduated from Colorado School of Mines in 2018 with my
            bachelor's in CS and 2019 with a master's in CS.
        \item I am an adjunct professor. Currently I'm teaching CSCI 341. I've
            taught 400, 406, and 564 in the past as well.
        \item I enjoy skiing, volleyball, and soccer.
        \item I'm a 4th degree black belt in ATA taekwondo.
    \end{itemize}
\end{frame}

\begin{frame}{Overview}
    \setbeamertemplate{section in toc}[sections numbered]
    \tableofcontents[hideallsubsections]

    \begin{block}{This talk is interactive!}
        If you have questions at any point, feel free to interrupt me.
    \end{block}
\end{frame}

\section{Why use Git?}

\begin{frame}{Example Scenario 1}

    \begin{enumerate}[<+->]
        \item You start a project called ``my-proj'' and write a ton of code.
        \item You finally get it to (kinda) work.
        \item You decide to make a copy of ``my-proj'' for backup purposes.
        \item You continue development on ``my-proj'' but then screw something
            up really bad.
        \item You decide to revert back to your copy.
        \item Then you realize your copy doesn't have a bug fix that you
            actually wanted.
        \item You then proceed to manually compare the files in the backup to
            those in your new code and figure out what you still want to have.
    \end{enumerate}

    \uncover<8>{This is terrible.}
\end{frame}

\begin{frame}{Example Scenario 2}

    \begin{enumerate}[<+->]
        \item You start working on a project with a partner.
        \item You write a bunch of code.
        \item You email the code in a \texttt{.zip} file, then go home for the
            weekend.
        \item You and your partner had decided to work on two separate tasks
            over the weekend so you make some changes to the code and your
            partner makes some changes to the code.
        \item You come together and start copying files. Then you realize you
            both modified \texttt{main()}.
        \item You then manually determine what changed in both files and
            reconcile them.
    \end{enumerate}

    \uncover<7>{This is awful.}
\end{frame}

\begin{frame}{Version Control Systems}

    Version Control Systems (VCSs) such as Git solve these problems.

    \begin{itemize}[<+->]
        \item VCS keeps track of \textit{revisions}, changes in the code in
            entities called \textit{changesets} or \textit{commits}.
        \item Most VCS allow version merging. That means multiple people can be
            working on the same file and resolve discrepancies later. Git is
            very elegant in handling merge conflicts such as this.
    \end{itemize}
\end{frame}

\begin{frame}{Git is popular}

    Git is a very popular version control system.

    Services such as GitHub and GitLab provide free hosting for Git
    repositories.

    It has become the de-facto industry standard for source control.

\end{frame}

\section{Understanding the Git data model}

\begin{frame}{Git is a distributed version control system}
    \textbf{Distributed} because you can use it without being connected to a
    central server. You have a full copy of the code on your own computer.

    \textbf{Version control} because it keeps track of changes to files.

    \pause

    \textbf{But how does it keep track of all of the changes?}
\end{frame}

\begin{frame}{Commits: what are they?}
    \textbf{Commits} are composed of two pieces of information: the previous
    commit(s) and a set of changes to be applied to those commits.\footnote[frame]{
        This is a bit of a lie, more on that later.}

    Commits reference their parent(s).

    \begin{center}
        \includegraphics[width=65mm]{graphics/branching5.png}
    \end{center}
\end{frame}

\begin{frame}{Commits: creating}
    You can create a commit by running \texttt{git commit}. This will create a
    commit based on the checked-out commit with the changes that you have
    ``staged''.
    \pause

    \begin{itemize}[<+->]
        \item You can stage changes by running \texttt{git add} and passing a
            list of files.
        \item You can stage all changes by running \texttt{git add -A}.
    \end{itemize}

    \pause[\thebeamerpauses]
    If you want to remove from the stage, you can run \texttt{git reset}
    (optionally passing a list of files to unstage).
\end{frame}

\begin{frame}[fragile]{Commits: what will be committed?}
    If you ever want to know what will be included in your commit, you can run
    \texttt{git status} to show the list of files staged for commit.
    \pause

    {
        \tiny
        \begin{minted}{text}
        > git status
        On branch master
        Your branch is up to date with 'origin/master'.

        Changes to be committed:
          (use "git restore --staged <file>..." to unstage)
                modified:   git.tex

        Changes not staged for commit:
          (use "git add <file>..." to update what will be committed)
          (use "git restore <file>..." to discard changes in working directory)
                modified:   git.pdf
                modified:   git.tex
        \end{minted}
    }

    \pause
    The \texttt{git.tex} file has only some lines staged for commit.
\end{frame}

\begin{frame}[fragile]{Commits: what will be committed, but with more detail?}
    To see the details of the changes that are staged (that is, will be
    committed), you can run \texttt{git diff --cached}.

    If you want to see the details of the changes that are \textit{not} staged,
    you can run \texttt{git diff}.

    \texttt{git diff} optionally accepts a list of files to diff.
    \pause

    {
        \tiny
        \begin{minted}{text}
            diff --git a/git.tex b/git.tex
            index 2c01a7b..91148d1 100644
            --- a/git.tex
            +++ b/git.tex
            @@ -33,9 +33,7 @@

             \section{Why use Git?}

            -\begin{frame}{Why use Git? I}
            -
            -    Example Scenario:
            +\begin{frame}{Example Scenario 1}

                 \begin{enumerate}[<+->]
                     \item You start a project called ``my-proj'' and write a ton of code.
        \end{minted}
    }
\end{frame}

\begin{frame}{Commits: summary}
    Use \texttt{git add} and \texttt{git reset} (or variants) to stage/unstage
    changes for your.
    \pause

    Use \texttt{git commit} to create a commit from the currently staged changes
    (which you can see by running \texttt{git diff --cached}).
\end{frame}

\begin{frame}{Branches}
    ohea
\end{frame}

\begin{frame}{Advanced Topics}
    Gitignore
\end{frame}

\begin{frame}
    \frametitle{How to use Git with a remote}

    \begin{itemize}
        \item Add Remote (\texttt{git remote add [name] [url]}): Adds a
            \textit{remote}, a version of the repository hosted externally from
            your local machine. Most likely on something like Github or an
            company's internal network.
        \item Push (\texttt{git push -u origin master}): Pushes all changes on
            the given branch to the remote.
        \item Clone (\texttt{git clone}): Copies the entire repository to the
            location.
        \item Fetch (\texttt{git fetch}): Retrieves changes from the remote.
        \item Merge (\texttt{git merge}): Merges a branch into another branch.
            (More on branches later, but in this case, we are merging the
            \texttt{origin/master} into our local \texttt{master} branch.)
        \item Pull (\texttt{git pull}): Retrieves any new changes from the
            remote and merges them with your local changes.
    \end{itemize}
\end{frame}

\begin{frame}
    \frametitle{Undoing Things}

    \begin{itemize}
        \item Undo the last $n$ commits (given that you haven't pushed them yet)
            \texttt{git reset --hard HEAD\textasciitilde n}
        \item Undo the $n^{th}$ to last commit by creating a new commit that
            reverts all of the changes \texttt{git revert HEAD\textasciitilde n}
        \item Somebody's done it before. Just Google it.
    \end{itemize}
\end{frame}

\begin{frame}
    \frametitle{Merging Changes I}

    What happens if multiple developers make changes to the same file? This will
    cause \textit{merge conflicts}.\\

    There are plenty of tools which you can use to \textit{resolve} such
    conflicts. None of them are that good because merge conflicts are just
    terrible in general.\\

    Play around with a bunch of them and see which one you like best. Here are a
    few to get you started: \texttt{Meld}, \texttt{KDiff3}, and
    \texttt{vimdiff}.\\
\end{frame}

\begin{frame}
    \frametitle{Merging Changes II}

    Invoking the \textit{mergetool}: use \texttt{git mergetool}.\\

    For each \textit{conflict}, you can choose to take their version, your
    version, a combination of the two or neither.\\

    Most UIs will give you three panes: one for the \textit{remote} version of
    the file, one for the \textit{local} version of the file and one for the
    merged version of the file.

\end{frame}

\begin{frame}
    \frametitle{Branches I}

    Branches allow you to separate develop a given functionality without
    affecting the original code base.\\

    For example, if you have an established product and you want to add a
    feature but you are uncertain about its viability, you can create a branch
    and build a prototype on that branch. If it fails, you can delete the branch
    and never see it again or if it works, you can \textit{merge} the branch
    back into \texttt{master}.
\end{frame}

\begin{frame}
    \frametitle{Branches\footnotemark II}
    Branches can be thought of as \textit{bookmarks} pointing to a specific
    changeset.

    \begin{center}
        \includegraphics[width=60mm]{graphics/branching1.png}
    \end{center}

    \textit{Note, \texttt{HEAD} is pointer to the current branch.}

    \footnotetext[3]{Info in the rest of the \textit{Branches} section is mainly
    from \url{https://git-scm.com/book/en/v1/Git-Branching-What-a-Branch-Is}}
\end{frame}

\begin{frame}
    \frametitle{Branches III}
    To switch branches, use \texttt{git checkout [branch]}. This moves
    \texttt{HEAD} to point to your new branch.

    \begin{center}
        \includegraphics[width=65mm]{graphics/branching2.png}
    \end{center}
\end{frame}

\begin{frame}
    \frametitle{Branches IV}
    If you commit something to your new branch, the branch pointer moves to the
    new commit. The pointer to \texttt{master} will not move.

    \begin{center}
        \includegraphics[width=65mm]{graphics/branching3.png}
    \end{center}
\end{frame}

\begin{frame}
    \frametitle{Branches V}
    Of course, you can always switch back to \texttt{master} using \texttt{git
    checkout master}.

    \begin{center}
        \includegraphics[width=65mm]{graphics/branching4.png}
    \end{center}
\end{frame}

\begin{frame}
    \frametitle{Branches VI}
    If you make a commit on the master branch, the \texttt{master} pointer moves
    to that new commit.  At this point, the branch histories have diverged.

    \begin{center}
        \includegraphics[width=65mm]{graphics/branching5.png}
    \end{center}
\end{frame}

\begin{frame}
    \frametitle{Branches VII: How to actually do it}

    \begin{itemize}
        \item \textbf{Create a Branch:} \texttt{git branch [branch\_name]}
        \item \textbf{Switch to a branch:} \texttt{git checkout [branch\_name]}
        \item \textbf{Create a new branch and switch to it:}\\ \texttt{git checkout -b [branch\_name]}
        \item \textbf{List branches:} \texttt{git branch}
        \item \textbf{Push branch to remote:} \texttt{git push -u [remote\_name] [branch\_name]}
    \end{itemize}
\end{frame}

\begin{frame}
    \frametitle{Merging Changes: Branch Edition}
    If you want changes from a different branch in your current branch, you can use \texttt{git
    merge [other branch]}.\\

    When you merge changes from another branch, one of two things will happen\footnotemark:

    \begin{enumerate}
        \item Your branch will be fast-forwarded to the other branch.\\
            This means that there are no changes in your current branch that are not in the other
            branch.
        \item A merge commit will be created and your branch pointer will be updated to point to
            this commit.\\
            This happens when there are changes in the current branch that are not in the other
            branch.
    \end{enumerate}

    \footnotetext[4]{These are the only ones I can thing of off the top of my head. You can force
    either of these functionalities with their respective command line options.}
\end{frame}

\begin{frame}
    \frametitle{Branch and Development Workflow}

    Branches are extremely scalable so you can ignore them, or use them for everything, it's your
    choice.\\

    One methodology used by companies in the industry is \texttt{Git Flow}. This is a system
    whereby new branches are created for every bugfix, new feature, release, and hotfix. If you want
    to learn more about it, look at this website:
    \url{http://nvie.com/posts/a-successful-git-branching-model/}
\end{frame}

\begin{frame}
    \frametitle{The Random Stuff: Stashing}

    When you have changes in your working directory, merges and switching branches (sometimes)
    doesn't work. You have two main options here:

    \begin{enumerate}
        \item Commit your changes. If you can do this, you should.
        \item Occasionally you just don't want to commit. In this case, you will want to
            \textit{stash} your changes using\\ \texttt{git stash [save [stash\_name]]}.
        \item To un-stash, use \texttt{git stash pop}. You may have to resolve merge conflicts.
    \end{enumerate}
\end{frame}

\begin{frame}
    \frametitle{The Random Stuff: Submodules}

    \textbf{What is a submodule?} It is literally a repository inside of another repository.\\

    \textbf{Why is this useful?} If you have a custom library shared between many projects, you can
    place that library in a standalone Git repository. Then you can add it as a submodule to your
    products via \texttt{git submodule add [clone\_url]}.

    The submodule is its own repository so it can be contributed to independently, but it can also
    be modified and contributed to as a submodule.
\end{frame}

\begin{frame}
    \frametitle{The Random Stuff: Rebasing}

    \textbf{What is it good for?} If you want to keep your graph clean, you can use rebasing to
    avoid merge commits.\\

    \textbf{Why would you use this?} I don't know. I never have and I normally want to see all of
    the changes in a graph, but it's a thing that you can do in Git and if you want to learn more,
    read the docs.
\end{frame}

\begin{frame}
    \frametitle{The Random Stuff: Aliases}

    As one would expect from something designed and built by Linus Torvalds, Git supports the
    concept of \textit{aliasing} one git command to another name.\\

    For example, you might want to alias \texttt{checkout} to \texttt{co}. This particular alias can
    be achieved using \\ \texttt{git config --global alias.co checkout}.\\

    Now you can invoke \texttt{git checkout} using \texttt{git co}.\\

    Another option is using your shell's alias functionality. This is often more powerful, but that
    isn't part of this talk.
\end{frame}

\begin{frame}
    \frametitle{The Random Stuff: Resources/Tips}

    I obviously was unable to tell you about everything you can do with Git. I've really only
    scratched the surface.

    \begin{itemize}
        \item \texttt{man git *}: The man pages on Git are good. Use them as your first line of
            defense.
        \item \texttt{git-scm.com/book/en/v2}: A huge resource about how to do everything Git.
        \item \texttt{gitignore.io}: Generates a \texttt{.gitignore} file for a given project type,
            OS, and IDE.
        \item \texttt{git reset --hard HEAD}: Undoes all changes since the last commit.
        \item \texttt{git diff HEAD:file1 file2}: Shows the difference between \texttt{file1} and
            \texttt{file2}.
    \end{itemize}
\end{frame}

\begin{frame}
    \frametitle{Where to Go from Here?}
    \begin{itemize}[<+->]
        \item If you haven't ever used Git, start by using it locally and with Github.
        \item If you know the basics, start exploring branches. Learn about them and find a flow
            which works best for you.
        \item If you know most things about Git, just keep using it. Try and start remembering how
            to do certain things that you find yourself often Googleing for. 
    \end{itemize}
    Become the person everyone asks for Git advice. It's used in the industry, so many companies
    will want to see knowledge of this tool.
\end{frame}

\end{document}
